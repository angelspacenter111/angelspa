<IfModule mod_deflate.c>
  # Enable gzip compression for specific file types
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/xml
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE application/xhtml+xml
  AddOutputFilterByType DEFLATE application/rss+xml
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
  AddOutputFilterByType DEFLATE application/json

  # Compress static files (e.g., Next.js output)
  <FilesMatch "\.(html|css|js|json|xml)$">
    SetOutputFilter DEFLATE
  </FilesMatch>

  # Add Vary header to prevent caching issues
  <IfModule mod_headers.c>
    Header append Vary Accept-Encoding
  </IfModule>

  # Set gzip compression level (1-9)
  DeflateCompressionLevel 6
</IfModule>

# Explicitly disable Brotli to ensure gzip is used
<IfModule mod_brotli.c>
  SetOutputFilter None
</IfModule>